<!doctype html>
<html>
  <body style="font-family: system-ui; padding:16px">
    <h3>Collect Test</h3>
    <input id="url" placeholder="Paste any URL (optional)" style="width:100%;padding:8px;border:1px solid #ccc;border-radius:8px" />
    <button id="send" style="margin-top:10px;padding:10px 14px;border:0;border-radius:10px;background:#000;color:#fff">
      Send to /api/collect
    </button>
    <pre id="out" style="white-space:pre-wrap;margin-top:14px"></pre>

    <script>
      const out = document.getElementById('out');
      document.getElementById('send').onclick = async () => {
        const url = document.getElementById('url').value || 'test';
        try {
          const res = await fetch('/api/collect', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              // Minimal payload; your API should still read IP & UA from headers
              url,
              userAgent: navigator.userAgent
            })
          });
          const json = await res.json();
          out.textContent = JSON.stringify(json, null, 2);
        } catch (e) {
          out.textContent = 'Error: ' + e.message;
        }
      };
    </script>
  </body>
</html>
